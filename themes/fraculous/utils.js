var GetXmlHttpObject=function(){var b;try{b=new XMLHttpRequest()}catch(c){try{b=new ActiveXObject("Msxml2.XMLHTTP")}catch(c){try{b=new ActiveXObject("Microsoft.XMLHTTP")}catch(c){}}}return b};var SendXmlHttpRequest=function(c,d,h,g,b,f){if(!c){return}c.open((g)?"POST":"GET",d,true);c.setRequestHeader("User-Agent","XMLHTTP/1.0");if(g){c.setRequestHeader("Content-type","application/x-www-form-urlencoded");c.setRequestHeader("Content-length",g.length);c.setRequestHeader("Connection","close")}c.onreadystatechange=function(){if(c.readyState!=4||(c.status!=200&&c.status!=304)){return}if(b){h(c.responseXML)}else{h(c.responseText)}if(f.update){setTimeout("SendXmlHttpRequest(ajax.xmlHttp, ajax.reqURL, ajax.oncomplete, ajax.data, ajax.xml, ajax)",f.update*1000)}};if(c.readyState==4){return}c.send(g.replace(/~/g,"%7E").replace(/%20/g,"+"))};var AJAX=function(c){return{xmlHttp:GetXmlHttpObject(),url:c.url,hash:null,reqURL:null,data:c.data||"",addData:function(f,d){this.data=(this.data)?this.data+"&"+f+"="+d:f+"="+d},clearData:function(){this.data=""},addHeader:function(f,d){this.xmlHttp.setRequestHeader(f,d)},onrequest:c.onrequest||_blank,onsuccess:c.success||_blank,onfail:c.onfail||_blank,oncomplete:c.oncomplete||_blank,update:c.update||false,request:function b(d){this.hash=d||"";this.reqURL=this.url+this.hash;this.onrequest();SendXmlHttpRequest(this.xmlHttp,this.reqURL,this.oncomplete,this.data,this.xml,this)},xml:c.xml||false}};var _blank=function(){};var addEvent=function(d,c,b){if(document.addEventListener){d.addEventListener(c,b,false)}else{if(document.attachEvent){d.attachEvent("on"+c,b)}}};var removeEvent=function(d,c,b){if(document.addEventListener){d.removeEventListener(c,b,false)}else{if(document.attachEvent){d.detachEvent("on"+c,b)}}};var $e=function(c){if(!c){var c=window.event}var b=(c.target?c.target:(c.srcElement?c.srcElement:document.body));return({event:c,caller:(b.nodeType==3?b.parentNode:b),code:(c.keyCode?c.keyCode:(c.which?c.which:null)),rclick:(c.button?c.button==2:(c.which?c.which==3:false)),delta:(c.wheelDelta?((window.opera?-1:1)*c.wheelDelta/120):(c.detail?-c.detail/3:0)),x:(c.pageX?c.pageX:(c.clientX?c.clientX+document.body.scrollLeft+document.documentElement.scrollLeft:0)),y:(c.pageY?c.pageY:(c.clientY?c.clientY+document.body.scrollTop+document.documentElement.scrollTop:0))})};var returnFalse=function(b){if(b.event){b=b.event}if(b.preventDefault){b.preventDefault()}else{b.returnValue=false}};var $=function(o,c,h){var k,g=0,l=0,q,b,n=[];o=explode(",",o);if(c&&!c.tagName){var h=c;c=document}else{if(!c){var c=document}}while(k=o[g++]){k=explode(/\s+/,$trim(k));b=explode("#",k.shift());l=b.length-1;b[l]=explode(".",b[l]);var d=0,m,r=(l?b[0]:b[l][0])||"*";m=(l?[document.getElementById(b[l][0])]:c.getElementsByTagName(r));if(m[0]){while(q=m[d++]){if((r=="*"||q.tagName==r.toUpperCase())&&(!b[l][1]||hasClass(q,b[l][1]))){q=(k.length>0)?$(k.join(" "),q):q;q=$Element(q);n=(n[0]?n.concat(q):[q])}}}}return(n.length==1&&h!==true)?n[0]:norm(n)};var explode=function(c,b){return(typeof(b=b.split(c))=="string")?[b]:b};var norm=function(b){var d=[],c=b.length;for(var g=0;g<c;g++){for(var f=g+1;f<c;f++){if(b[g]===b[f]){f=++g}}d.push(b[g])}return d};var $trim=function(f,d){d=d||"\\s";var f=f.replace(new RegExp("^["+d+"]+","g"),""),b=new RegExp("["+d+"]"),c=f.length;while(b.test(f.charAt(--c))){}return f.slice(0,c+1)};var $Element=function(c,d){var b=(c.tagName?c:document.createElement(c));if(d){if(d.insert){delete (d.append)}if(d.className){d["class"]=d.className}if(d.enctype){d.encoding=d.enctype}for(a in d){switch(a){case"style":for(s in d[a]){b.style[s]=d[a][s]}break;case"events":for(e in d[a]){addEvent(b,e,(d[a][e]))}break;case"insert":d[a].parentNode.insertBefore(b,d[a]);break;case"append":d[a].appendChild(b);break;case"innerHTML":b.innerHTML=d[a];break;default:b[a]=d[a];break}}}if(!b.hasClass){b.$style=function(g,f){return $style(this,g,f)};b.classes=function(){return classes(this)};b.hasClass=function(f){return hasClass(this,f)};b.classLike=function(f){return classLike(this,f)};b.addClass=function(f){return addClass(this,f)};b.removeClass=function(f){return removeClass(this,f)};b.addEvent=function(h,g){return addEvent(this,h,g)};b.removeEvent=function(h,g){return removeEvent(this,h,g)};b.update=function(f){return $Element(this,f)};b.allChildren=function(){return $("*",this,true)};b.ancestors=function(){var g=[],f=this;while((f=f.parentNode)&&f.tagName){g.push($Element(f))}return g};b.descendsFrom=function(g){var f=this;while(f=f.parentNode){if(f==g){return true}}return false};b.remove=function(){return this.parentNode.removeChild(this)}}return b};var $style=function(g,c,b){var d;if(!b){if(d=g.currentStyle){return d[CSStoJS(c)]}if(d=window.getComputedStyle){return d(g,"").getPropertyValue(c)}}c.style[CSStoJS(c)]=b};var classes=function(b){return explode(" ",b.className)};var hasClass=function(g,h){var f=0,d=null,b=classes(g);while(d=b[f++]){if(d==h){return true}}return false};var classLike=function(j,k){var g=0,d=null,b=classes(j),h=new RegExp(k),f=[];while(d=b[g++]){if(h.test(d)){f[f.length]=d}}if(f.length){return f}return false};var addClass=function(b,d){if(!hasClass(b,d)){b.className=b.className+" "+d}};var removeClass=function(g,h){var f=0,d=null,b=classes(g);while(d=b[f++]){if(d==h){b[f-1]=""}}g.className=b.join(" ")};var CSStoJS=function(b){return b.replace(/\-(.)/g,function(c,d){return d.toUpperCase()})};var JStoCSS=function(b){return b.replace(/[A-Z]/,function(c){return"-"+c.toLowerCase()})};var getElementsByRole=function(h){if(!h){var h=document}var c=[],b,g,d=0,f=h.getElementsByTagName("*");while(g=f[d++]){if(g.getAttribute("role")){c[c.length]=g}}return c};function $FormData(g){var b=0,h=null,d=null,c=$("input,select,textarea",g,true);while(h=c[b++]){d=(d?d+"&":"")+(h.name?h.name:(h.id?h.id:h.tagName+"_"+b))+"="+h.value}return d}function XMLUpdate(xml){if(!xml){alert("An Error has occured. Please forward the folowing information to Daniel Lanigan:\n\nLocation: "+location.href+"\n\n"+xHttp.xmlHttp.responseText)}var i=0,update,updates=xml.getElementsByTagName("*");while(update=updates[i++]){switch(update.tagName){case"update":var node=$("#"+update.getAttribute("for"));switch(update.getAttribute("what")){case"remove":node.parentNode.removeChild(node);break;case"append":node.innerHTML+=update.childNodes[0].data;roleModel(node);break;default:node.innerHTML=update.childNodes[0].data;roleModel(node);break}break;case"script":eval("("+update.childNodes[0].data+")");break}}}function roleModel(c){var o=null,g=0,k=null,m=getElementsByRole(c);while(k=m[g++]){o=k.getAttribute("role");var f=0,d=null,q=o.split(" ");if(!k.hasRole){while(d=q[f++]){k.hasRole=true;var n=explode("-",o),p;if(n[1]){p=n[1].replace("on","")}else{p="click"}switch(n[0]){case"noscript":k.style.display="none";break;case"link":addEvent(k,p,function(j){var i=$e(j);changeCollection(i.caller.value);returnFalse(i)});break;case"update":addEvent(k,p,function(j){var i=$e(j);xHttp.request(document.body.id.replace(/-/g,"/")+"&data="+(i.caller.getAttribute("name")?i.caller.getAttribute("name")+"/"+i.caller.value:i.caller.id));returnFalse(i)});break;case"submit":var b=k;while(b.parentNode&&b!=document.body&&b.tagName!="FORM"){b=b.parentNode}if(b.tagName!="FORM"){break}else{k.submitForm=b}addEvent(k,p,function(r){var l,j=$e(r),i;if(l=j.caller.submitForm){i=l.method.toUpperCase();if(i=="POST"){xHttp.data=$FormData(l)}xHttp.request(document.body.id.replace(/-/g,"/")+(i!="POST"?"&"+$FormData(l):""))}xHttp.clearData();returnFalse(j)});break;case"labeler":var h=$("#"+k.getAttribute("for"));h.display=$style(h,"display");h.style.display="none";addEvent(k,"click",function(j){var i=$e(j);i.caller.style.display="none";j=$("#"+i.caller.getAttribute("for"));if(j.display){j.style.display=j.display;delete j.display}});break;case"expanding":k.fullText=k.innerHTML;switch(p){case"all":k.innerHTML="";break;case"newline":k.innerHTML=k.innerHTML.replace(/\n(.*)/,"");break;case"br":k.innerHTML=k.innerHTML.replace(/<br>(.*)/,"");break}if(k.fullText!=k.innerHTML){$Element("a",{href:"#",events:{click:function(j){var i=$e(j).caller.parentNode;i.shortText=i.innerHTML;i.innerHTML=i.fullText;returnFalse($e(j))}},style:{display:"inline",paddingLeft:"10px",color:"blue",textDecoration:"underline"},innerHTML:"More",append:k})}break}}}}};
