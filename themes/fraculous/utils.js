var GetXmlHttpObject=function(){var a;try{a=new XMLHttpRequest()}catch(e){try{a=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{a=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}}return a};var SendXmlHttpRequest=function(a,b,c,d,e,f){if(!a)return;a.open((d)?"POST":"GET",b,true);a.setRequestHeader('User-Agent','XMLHTTP/1.0');if(d){a.setRequestHeader('Content-type','application/x-www-form-urlencoded');a.setRequestHeader("Content-length",d.length);a.setRequestHeader("Connection","close")}a.onreadystatechange=function(){if(a.readyState!=4||(a.status!=200&&a.status!=304))return;if(e)c(a.responseXML);else c(a.responseText);if(f.update)setTimeout('SendXmlHttpRequest(ajax.xmlHttp, ajax.reqURL, ajax.oncomplete, ajax.data, ajax.xml, ajax)',f.update*1000)}if(a.readyState==4)return;a.send(d.replace(/~/g,'%7E').replace(/%20/g,'+'))};var AJAX=function(o){return{xmlHttp:GetXmlHttpObject(),url:o.url,hash:null,reqURL:null,data:o.data||'',addData:function(p,v){this.data=(this.data)?this.data+'&'+p+'='+v:p+'='+v},clearData:function(){this.data=''},addHeader:function(p,v){this.xmlHttp.setRequestHeader(p,v)},onrequest:o.onrequest||_blank,onsuccess:o.success||_blank,onfail:o.onfail||_blank,oncomplete:o.oncomplete||_blank,update:o.update||false,request:function request(a){this.hash=a||'';this.reqURL=this.url+this.hash;this.onrequest();SendXmlHttpRequest(this.xmlHttp,this.reqURL,this.oncomplete,this.data,this.xml,this)},xml:o.xml||false}};var _blank=function(){};var addEvent=function(o,e,f){if(document.addEventListener)o.addEventListener(e,f,false);else if(document.attachEvent)o.attachEvent('on'+e,f)};var removeEvent=function(o,e,f){if(document.addEventListener)o.removeEventListener(e,f,false);else if(document.attachEvent)o.detachEvent('on'+e,f)};var $e=function(e){if(!e)var e=window.event;var a=(e.target?e.target:(e.srcElement?e.srcElement:document.body));return({event:e,caller:(a.nodeType==3?a.parentNode:a),code:(e.keyCode?e.keyCode:(e.which?e.which:null)),rclick:(e.button?e.button==2:(e.which?e.which==3:false)),delta:(e.wheelDelta?((window.opera?-1:1)*e.wheelDelta/120):(e.detail?-e.detail/3:0)),x:(e.pageX?e.pageX:(e.clientX?e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft:0)),y:(e.pageY?e.pageY:(e.clientY?e.clientY+document.body.scrollTop+document.documentElement.scrollTop:0))})};var returnFalse=function(e){if(e.event)e=e.event;if(e.preventDefault)e.preventDefault();else e.returnValue=false};var $=function(a,b,c){var f,i=0,len=0,e,p,ret=[];a=explode(',',a);if(b&&!b.tagName){var c=b;b=document}else if(!b)var b=document;while(f=a[i++]){f=explode(/\s+/,$trim(f));p=explode('#',f.shift());len=p.length-1;p[len]=explode('.',p[len]);var j=0,list,tag=(len?p[0]:p[len][0])||'*';list=(len?[document.getElementById(p[len][0])]:b.getElementsByTagName(tag));if(list[0])while(e=list[j++])if((tag=='*'||e.tagName==tag.toUpperCase())&&(!p[len][1]||hasClass(e,p[len][1]))){e=(f.length>0)?$(f.join(' '),e):e;e=$Element(e);ret=(ret[0]?ret.concat(e):[e])}}return(ret.length==1&&c!==true)?ret[0]:norm(ret)};var explode=function(d,o){return(typeof(o=o.split(d))=='string')?[o]:o};var norm=function(b){var a=[],l=b.length;for(var i=0;i<l;i++){for(var j=i+1;j<l;j++)if(b[i]===b[j])j=++i;a.push(b[i])}return a};var $trim=function(a,b){b=b||'\\s';var a=a.replace(new RegExp("^["+b+"]+","g"),''),ws=new RegExp("["+b+"]"),i=a.length;while(ws.test(a.charAt(--i)));return a.slice(0,i+1)};var $Element=function(t,o){var d=(t.tagName?t:document.createElement(t));if(o){if(o['insert'])delete(o['append']);if(o['className'])o['class']=o['className'];if(o['enctype'])o['encoding']=o['enctype'];for(a in o)switch(a){case'style':for(s in o[a])d.style[s]=o[a][s];break;case'events':for(e in o[a])addEvent(d,e,(o[a][e]));break;case'insert':o[a].parentNode.insertBefore(d,o[a]);break;case'append':o[a].appendChild(d);break;case'innerHTML':d.innerHTML=o[a];break;default:d[a]=o[a];break}}if(!d.hasClass){d.$style=function(s,v){return $style(this,s,v)};d.classes=function(){return classes(this)};d.hasClass=function(c){return hasClass(this,c)};d.classLike=function(c){return classLike(this,c)};d.addClass=function(c){return addClass(this,c)};d.removeClass=function(c){return removeClass(this,c)};d.addEvent=function(e,f){return addEvent(this,e,f)};d.removeEvent=function(e,f){return removeEvent(this,e,f)};d.update=function(o){return $Element(this,o)};d.allChildren=function(){return $('*',this,true)};d.ancestors=function(){var b=[],a=this;while((a=a.parentNode)&&a.tagName)b.push($Element(a));return b};d.descendsFrom=function(e){var a=this;while(a=a.parentNode)if(a==e)return true;return false};d.remove=function(){return this.parentNode.removeChild(this)}}return d};var $style=function(e,s,v){var f;if(!v){if(f=e.currentStyle)return f[CSStoJS(s)];if(f=window.getComputedStyle)return f(e,"").getPropertyValue(s)}s.style[CSStoJS(s)]=v};var classes=function(e){return explode(' ',e.className)};var hasClass=function(e,c){var i=0,cl=null,cls=classes(e);while(cl=cls[i++])if(cl==c)return true;return false};var classLike=function(e,c){var i=0,cl=null,cls=classes(e),reg=new RegExp(c),ret=[];while(cl=cls[i++])if(reg.test(cl))ret[ret.length]=cl;if(ret.length)return ret;return false};var addClass=function(e,c){if(!hasClass(e,c))e.className=e.className+' '+c};var removeClass=function(e,c){var i=0,cl=null,cls=classes(e);while(cl=cls[i++])if(cl==c)cls[i-1]='';e.className=cls.join(' ')};var CSStoJS=function(a){return a.replace(/\-(.)/g,function(m,l){return l.toUpperCase()})};var JStoCSS=function(a){return a.replace(/[A-Z]/,function(m){return'-'+m.toLowerCase()})};var getElementsByRole=function(n){if(!n)var n=document;var b=[],a,e,i=0,all=n.getElementsByTagName('*');while(e=all[i++]){if(e.getAttribute('role'))b[b.length]=e}return b};function $FormData(f){var i=0,e=null,data=null,list=$("input,select,textarea",f,true);while(e=list[i++])data=(data?data+'&':'')+(e.name?e.name:(e.id?e.id:e.tagName+'_'+i))+'='+e.value;return data}function XMLUpdate(a){if(!a)alert('An Error has occured. Please forward the folowing information to Daniel Lanigan:\n\nLocation: '+location.href+'\n\n'+xHttp.xmlHttp.responseText);var i=0,update,updates=a.getElementsByTagName('*');while(update=updates[i++])switch(update.tagName){case'update':var b=$('#'+update.getAttribute('for'));switch(update.getAttribute('what')){case'remove':b.parentNode.removeChild(b);break;case'append':b.innerHTML+=update.childNodes[0].data;roleModel(b);break;default:b.innerHTML=update.childNodes[0].data;roleModel(b);break}break;case'script':eval('('+update.childNodes[0].data+')');break}}function roleModel(b){var a=null,i=0,e=null,list=getElementsByRole(b);while(e=list[i++]){a=e.getAttribute('role');var j=0,l=null,s=a.split(' ');if(!e.hasRole)while(l=s[j++]){e.hasRole=true;var c=explode('-',a),evt;if(c[1])evt=c[1].replace('on','');else evt='click';switch(c[0]){case'noscript':e.style.display='none';break;case'link':addEvent(e,evt,function(e){var a=$e(e);changeCollection(a.caller.value);returnFalse(a)});break;case'update':addEvent(e,evt,function(e){var a=$e(e);xHttp.request(document.body.id.replace(/-/g,'/')+'&data='+(a.caller.getAttribute('name')?a.caller.getAttribute('name')+'/'+a.caller.value:a.caller.id));returnFalse(a)});break;case'submit':var d=e;while(d.parentNode&&d!=document.body&&d.tagName!='FORM')d=d.parentNode;if(d.tagName!='FORM')break;else e.submitForm=d;addEvent(e,evt,function(e){var f,evt=$e(e),m;if(f=evt.caller.submitForm){m=f.method.toUpperCase();if(m=='POST')xHttp.data=$FormData(f);xHttp.request(document.body.id.replace(/-/g,'/')+(m!='POST'?'&'+$FormData(f):''))}xHttp.clearData();returnFalse(evt)});break;case'labeler':var g=$('#'+e.getAttribute('for'));g['display']=$style(g,'display');g.style.display='none';addEvent(e,'click',function(e){var a=$e(e);a.caller.style.display='none';e=$('#'+a.caller.getAttribute('for'));if(e['display']){e.style.display=e['display'];delete e['display']}});break;case'expanding':e.fullText=e.innerHTML;switch(evt){case'all':e.innerHTML='';break;case'newline':e.innerHTML=e.innerHTML.replace(/\n(.*)/,'');break;case'br':e.innerHTML=e.innerHTML.replace(/<br>(.*)/,'');break}if(e.fullText!=e.innerHTML)$Element('a',{href:'#',events:{click:function(e){var a=$e(e).caller.parentNode;a.shortText=a.innerHTML;a.innerHTML=a.fullText;returnFalse($e(e))}},style:{display:'inline',paddingLeft:'10px',color:'blue',textDecoration:'underline'},innerHTML:'More',append:e});break}}}}
